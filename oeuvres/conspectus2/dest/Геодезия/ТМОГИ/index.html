<!DOCTYPE html><html lang="ru"><head><title>ТМОГИ</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" href="../../style.css"><script defer type="text/javascript" src="../../script.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.css" integrity="sha384-3UiQGuEI4TTMaFmGIZumfRPtfKQ3trwQE2JgosJxCnGmQpL/lJdjpcHkaaFwHlcI" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js" integrity="sha384-G0zcxDFp5LWZtDuRMnBkk3EphCK1lhEf4UEyEM693ka574TZGwo4IWwS6QLzM/2t" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script></head><body><main><details><summary>другие конспекты</summary><nav id="navigation"><div class="blockname">Геодезия</div><div class="block"><a class="disciplinename" href="../../Геодезия/Высшая геодезия">Высшая геодезия</a><a class="disciplinename" href="../../Геодезия/Космическая геодезия">Космическая геодезия</a><a class="disciplinename" href="../../Геодезия/Основы геодезии">Основы геодезии</a><a class="disciplinename" href="../../Геодезия/Основы картографии">Основы картографии</a><a class="disciplinename" href="../../Геодезия/ТМОГИ">ТМОГИ</a><a class="disciplinename" href="../../Геодезия/Топопланы">Топопланы</a></div><div class="blockname">Дистанционное зондирование</div><div class="block"><a class="disciplinename" href="../../Дистанционное зондирование/АКС">АКС</a><a class="disciplinename" href="../../Дистанционное зондирование/Дешифрование">Дешифрование</a></div><div class="blockname">Земная кора</div><div class="block"><a class="disciplinename" href="../../Земная кора/Геоморфология">Геоморфология</a><a class="disciplinename" href="../../Земная кора/Камни">Камни</a><a class="disciplinename" href="../../Земная кора/Месторождения">Месторождения</a><a class="disciplinename" href="../../Земная кора/Основы геологии">Основы геологии</a><a class="disciplinename" href="../../Земная кора/Почвы">Почвы</a></div><div class="blockname">Математика и физика</div><div class="block"><a class="disciplinename" href="../../Математика и физика/Математический анализ">Математический анализ</a><a class="disciplinename" href="../../Математика и физика/Теория вероятностей">Теория вероятностей</a><a class="disciplinename" href="../../Математика и физика/Физика атмосферы">Физика атмосферы</a><a class="disciplinename" href="../../Математика и физика/Физика морей и океанов">Физика морей и океанов</a></div></nav></details><details open><summary>содержание</summary><nav id="toc"><a class="H2" data-id="toc-id-0">Теория математической обработки геодезических измерений</a><a class="H3" data-id="toc-id-1">Аннотация</a><a class="H3" data-id="toc-id-2">ТМОГИ. Измерения и ошибки.</a><a class="H3" data-id="toc-id-3">Средняя квадратическая ошибка.</a><a class="H4" data-id="toc-id-4">СКО одного измерения</a><a class="H4" data-id="toc-id-5">СКО среднего арифметического</a><a class="H4" data-id="toc-id-6">СКО функции</a><a class="H3" data-id="toc-id-7">Доверительные интервалы</a><a class="H4" data-id="toc-id-8">Доверительный интервал возможного значения истинной величины измеренного значения</a><a class="H4" data-id="toc-id-9">Доверительный интервал СКО одного измерения (дисперсии единицы веса)</a><a class="H4" data-id="toc-id-10">Доверительный интервал СКО среднего арифметического (дисперсии среднего весового общей арифметической средины)</a><a class="H3" data-id="toc-id-11">Неравноточные измерения</a><a class="H4" data-id="toc-id-12">СКО неравноточных измерений</a><a class="H4" data-id="toc-id-13">Вес функции</a><a class="H3" data-id="toc-id-14">Двойные измерения.</a><a class="H4" data-id="toc-id-15">Оценка точности по разностям двойных равноточных измерений.</a><a class="H4" data-id="toc-id-16">Оценка точности по разностям двойных неравноточных измерений.</a><a class="H3" data-id="toc-id-17">Нормальная стандартная величина. Правило трёх сигм.</a><a class="H3" data-id="toc-id-18">Формула обобщённой оценки точности</a><a class="H3" data-id="toc-id-19">Переопределённые системы уравнений. Задача уравнивания.</a><a class="H3" data-id="toc-id-20">Параметрический способ уравнивания.</a><a class="H4" data-id="toc-id-21">Вывод основных формул, порядок уравнивания.</a><a class="H4" data-id="toc-id-22">Контроль уравнительных вычислений.</a><a class="H4" data-id="toc-id-23">Оценка точности в параметрическом способе уравнивания.</a><a class="H4" data-id="toc-id-24">Ошибка единицы веса</a><a class="H4" data-id="toc-id-25">Оценка точности уравненных неизвестных</a><a class="H4" data-id="toc-id-26">Оценка точности функции уравненных неизвестных</a><a class="H3" data-id="toc-id-27">Коррелатный способ уравнивания.</a><a class="H4" data-id="toc-id-28">Вывод основных формул коррелатного способа уравнивания</a><a class="H4" data-id="toc-id-29">Порядок уравнивания коррелатным способом</a><a class="H4" data-id="toc-id-30">Контроль грубых ошибок по невязкам условных уравнений</a><a class="H4" data-id="toc-id-31">Оценка точности в коррелатном способе уравнивания</a><a class="H4" data-id="toc-id-32">Вывод формулы Бесселя для вычисления ошибки единицы веса</a><a class="H4" data-id="toc-id-33">Оценка точности измерений при коррелатном способе уравнивания</a><a class="H4" data-id="toc-id-34">Оценка точности функций уравненных измерений</a><a class="H4" data-id="toc-id-35">Повышение веса в результате уравнивания</a><a class="H3" data-id="toc-id-36">Примеры задач</a><a class="H4" data-id="toc-id-37">Вычисление СКО функции</a><a class="H4" data-id="toc-id-38">Обратная задача оценки точности</a></nav></details><article id="conspect"><html><head></head><body><h2 id="toc-id-0">Теория математической обработки геодезических измерений</h2>
<p>Основано на лекциях/семинарах Андоленко Светланы Степановны, Курченко Леонида Алексеевича, Пичугиной Елены Алексеевны.</p>
<h3 id="toc-id-1">Аннотация</h3>
<h3 id="toc-id-2">ТМОГИ. Измерения и ошибки.</h3>
<p>ТМОГИ - это математическая дисциплина, которая изучает и разрабатывает методы оценки точности измерений, методы расчёта точности измерений, а также методы определения наиболее достоверных значений, определяемых неизвестных параметров и их оценки точности.</p>
<p>Если измерения происходят в одних и тех же условиях одним и тем же прибором, одним и тем же исполнителем, то такие измерения называются <em>равноточными</em>. <em>Неравноточные</em> измерения выполнены различным числом приёмов, различными приборами, утром, вечером...</p>
<p>При геодезических измерениях неизбежны ошибки. Эти ошибки бывают грубые, систематические и случайные.</p>
<ul>
<li>К <em>грубым</em> относятся просчёты в измерениях. Эти ошибки легко определяются и исключаются из измерений. Данные измерения необходимо перемерить.</li>
<li><em>Систематические</em> ошибки происходят от известного источника, имеют определённый знак и величину и их можно учесть при измерениях и вычислениях.</li>
<li><em>Случайные</em> ошибки возникают от воздействия самых разнообразных причин. Влияние их учесть практически невозможно.</li>
</ul>
<p>Поэтому возникают две задачи, решаемые с помощью теории ошибок измерений:</p>
<ol>
<li>Из результатов измерений получить наиболее точную величину;</li>
<li>Оценить точность полученных результатов измерений.</li>
</ol>
<p>Относительная ошибка — это отношение абсолютной ошибки к значению самой измеренной величины. Относительная ошибка выражается в виде аликвотной дроби, числитель которой — единица, а знаменатель — число округлённое до двух-трёх значащих цифр с нолями в меньшую сторону.</p>
<p>В теории ошибок измерений вводится приближённая формула для определения ошибок
вычисления СКП: mm (средняя квадратическая погрешность средней квадратической по-
грешности)
$$m_m=\frac m{2\sqrt{n}}$$
Так, при n = 8 получим mm = 0.25m (т.е. ошибка вычисления СКП может достигнуть 25%
от её величины, при 8 ⩽ n ⩽ 50 измерений). При n = 50, получим mm = 0.10m;</p>
<h3 id="toc-id-3">Средняя квадратическая ошибка.</h3>
<h4 id="toc-id-4">СКО одного измерения</h4>
<p>Точность результатов измерений оценивается средней квадратической погрешностью (СКО одного измерения), предложенной Гауссом:
$$m=\sqrt\frac{[\Delta^2]}n$$
где $\Delta$ - разность между измерением величины и её истинным значением.</p>
<h4 id="toc-id-5">СКО среднего арифметического</h4>
<p>СКО среднего арифметического $\Theta$ измерений $l_i$ выводится следующим образом:</p>
<ol>
<li>Разложим среднее арифметическое: $$\Theta=\frac{l_1}n+\frac{l_2}n+\ldots+\frac{l_n}n$$</li>
<li>СКО аналогична квадратному корню дисперсии. При независимых измерениях дисперсия суммы равна сумме дисперсий: $$D\Theta=D\left(\frac{l_1}n\right)+D\left(\frac{l_2}n\right)+\ldots+D\left(\frac{l_n}n\right)$$ $$D\Theta=\frac1{n^2}Dl_1+\frac1{n^2}Dl_2+\ldots+\frac1{n^2}Dl_n$$ $$M^2=\frac{m_1^2}{n^2}+\frac{m_2^2}{n^2}+\ldots+\frac{m_n^2}{n^2}$$</li>
<li>Так как измерения равноточны ($m_1=m_2=\ldots=m_n$), то $$M^2=\frac{m^2}n$$</li>
<li>Таким образом, среднее арифметическое в $\sqrt n$ раз точнее результата отдельного измерения. $$M=\frac m{\sqrt n}$$</li>
</ol>
<h4 id="toc-id-6">СКО функции</h4>
<p>Запишем уравнения связи между измеренными значениями и неизвестными
$$Y=\varphi(X)$$
В общем случае уравнения связи нелинейные. Приведём их к линейному виду, разложив в ряд Тейлора:
$$Y=\varphi\left(X^{(0)}\right)+\frac{\partial Y}{\partial X}\left(X-X^{(0)}\right)+\zeta$$
Найдём её дисперсию, приняв, что аргументы функции независимы, и отбросив последний член:
$$DF=D(const)+D\left(\frac{\partial Y}{\partial X}\left(X-X^{(0)}\right)\right)=\left(\frac{\partial Y}{\partial X}\right)^2(DX-DX^{(0)})=\left(\frac{\partial Y}{\partial X}\right)^2DX$$
$$DF=\sum_1^n\left(\frac{\partial F}{\partial x_i}\right)^2Dx_i$$
$$m_F^2=\sum_1^n\left(\frac{\partial F}{\partial x_i}\right)^2m_x^2$$
Если измерения не независимы, то:
$$m_F^2=\sum_1^n\left(\frac{\partial F}{\partial x_i}\right)^2m_x^2+2\sum_{i&lt;j}\frac{\partial F}{\partial x_i}\cdot\frac{\partial F}{\partial x_j}\cdot r_{x_ix_j}m_{x_i}m_{x_j}$$</p>
<h3 id="toc-id-7">Доверительные интервалы</h3>
<h4 id="toc-id-8">Доверительный интервал возможного значения истинной величины измеренного значения</h4>
<p>$$\overline x-t_\beta\cdot m_{\overline x}\leq M_x\leq\overline x+t_\beta\cdot m_{\overline x}$$
где $\overline x$ - наиболее достоверное значение измеренной величины; $\beta$ - доверительная вероятность; $t_\beta$ находится по таблице распределения Стьюдента. </p>
<h4 id="toc-id-9">Доверительный интервал СКО одного измерения (дисперсии единицы веса)</h4>
<p>$$\gamma_1\cdot\mu^2\leq\sigma_0^2\leq\gamma_2\cdot\mu^2$$
Значения $\gamma_1$ и $\gamma_2$ берутся из таблицы исходя из числа степеней свободы и доверительного интервала.
![[коэффициенты гамма1и2-80.png]]</p>
<h4 id="toc-id-10">Доверительный интервал СКО среднего арифметического (дисперсии среднего весового общей арифметической средины)</h4>
<p>$$\gamma_1\cdot M^2\leq\sigma_{\overline x}^2\leq\gamma_2\cdot M^2$$</p>
<h3 id="toc-id-11">Неравноточные измерения</h3>
<h4 id="toc-id-12">СКО неравноточных измерений</h4>
<p>Нарушение условий равноточности приводит к измерениям с различными СКО. Для характеристики таких измерений дополнительно вводят понятие веса измерения:
$$p_i=\frac{c}{m_i^2}$$
где $c$ - произвольная величина (дисперсия единицы веса).</p>
<p>Среднее арифметическое в случае неравноточных измерений вычисляется следующим образом:
$$\overline x=\frac{[px]}{[p]}$$
Ошибка единицы веса:
$$\mu=\sqrt{\frac{[p\Delta^2]}n}\quad\text{или}\quad\mu=\sqrt{\frac{[pv^2]}{n-1}}$$
Обычно в формуле веса постоянную $c$ выбирают равной квадрату ошибки единицы веса:
$$p_i=\frac{\mu^2}{m_i^2}\Rightarrow m_i=\frac\mu{\sqrt{p_i}}$$</p>
<h4 id="toc-id-13">Вес функции</h4>
<p>Применим выражение $m_i=\frac\mu{\sqrt{p_i}}$ в формуле СКО функции:
$$\frac{\mu^2}{p_F}=\sum_1^n\left(\frac{\partial F}{\partial x_i}\right)^2\frac{\mu^2}{p_i}$$
Сократив $\mu^2$, получим формулу обратного веса функции:
$$\frac{1}{p_F}=\sum_1^n\left(\frac{\partial F}{\partial x_i}\right)^2\frac{1}{p_i}$$</p>
<h3 id="toc-id-14">Двойные измерения.</h3>
<p>Часто в геодезии величины измеряются только два раза. Такие измерения называются двойными. Различают двойные равноточные измерения, когда измерения в парах равноточны, и пары также равноточны между собой, а также двойные неравноточные измерения, когда измерения в парах равноточны, а пары между собой неравноточны.</p>
<h4 id="toc-id-15">Оценка точности по разностям двойных равноточных измерений.</h4>
<p>Пусть имеются двойные равноточные измерения:
$$\begin{aligned}x_1,x_2,\ldots,x_n\\  x_1',x_2',\ldots,x_n'\end{aligned}$$
и составлены из разности $d_i=x_i-x_i'$. При отсутствии систематических ошибок эти разности можно рассматривать ошибки величин, истинное значение которых равно нулю. Поэтому можем применить формулу Гаусса:
$$m_d=\sqrt{\frac{[d^2]}{n}};\quad m_{x_i}=\sqrt{\frac{}{2}}$$
Точность среднего арифметического из двух измерений:
$$m_{x_{i,ср}}=\frac{m_x}{\sqrt2}$$
На наличие в $d_i$ постоянной систематической ошибки укажет значительное отклонение от нуля величины $\Theta=[d]/n$. В этом случае, рассматривая разности $d_i'=d_i-\Theta$ как уклонения от арифметической средины и применяя формулу Бесселя, получим:
$$m_d=\sqrt{\frac{[d'^2]}{n-1}}$$
На основании формулы $\left|[\Delta]\right|\leq 2.5[\left|\Delta\right|]\sqrt n$ напишем неравенство, при невыполнении которого можно принять гипотезу о наличии в разностях $d_i$ систематической ошибки
$$|[d]|\leq2.5[|d|]/\sqrt n$$</p>
<h4 id="toc-id-16">Оценка точности по разностям двойных неравноточных измерений.</h4>
<p>Рассматривая разность измерений как линейную функцию, можем вычислить вес разности:
$$\frac1{p_{d_i}}=(1)^2\frac1{p_{x_i}}+(-1)^2\frac1{p_{x^\prime_i}}=\frac2{p_{x_i}}$$
$$p_{d_i}=\frac{p_{x_i}}2=\frac{p_i}2$$
При отсутствии систематических ошибок получим ошибку единицы веса и СКО средних значений:
$$\mu=\sqrt{\frac{p_dd^2}n}$$
$$m_{x_{i,ср}}=\frac\mu{\sqrt{2p_i}}$$
Если разности $d_i$ содержат систематические ошибки, то величина $\Theta=[pd]/[p]$ будет заметно отличаться от нуля. Тогда будем иметь:
$$\mu=\sqrt{\frac{[p_dd'^2]}{n-1}}$$
где $d'_i=d_i-\Theta$.</p>
<p>Критерием наличия постоянной систематической ошибки может служить невыполнение неравенства
$$|[p_dd|\leq2.5[|p_dd|]/\sqrt{[p_d]}$$</p>
<h3 id="toc-id-17">Нормальная стандартная величина. Правило трёх сигм.</h3>
<p>Величину $t=\frac{x-Mx}{\sigma}$ называют нормальной стандартной величиной. Она обладает следующими свойствами:</p>
<ol>
<li>$Mt=M(\frac{x-Mx}{\sigma})=\frac{1}{\sigma}\left(Mx-M(Mx)\right)=\frac{1}{\sigma}\left(Mx-Mx\right)=0$;</li>
<li>$D_t=D(\frac{x-Mx}{\sigma})=\frac{1}{\sigma^2}\left(Dx-D(Mx)\right)=\frac{1}{\sigma^2}\cdot Dx=1$;</li>
</ol>
<p>Учитывая, что функция Лапласа нечётная, а также с учётом формулы для вычисления $t$, получим
$$mP(|x-a|\leq t\cdot\sigma)=\Phi(t)$$
При $t=1$, $\Phi(t)=0.68$; при $t=2$, $\Phi(t)=0.975$; при $t=3$, $\Phi(t)=0.997$.</p>
<p>Таким образом, если случайная величина распределена нормально, то её отклонение от математического ожидания, взятое по абсолютной величине, не превышает утроенного СКО с вероятностью 99.7%.</p>
<h3 id="toc-id-18">Формула обобщённой оценки точности</h3>
<p>Пусть $\varphi(X)$ - вектор-функция, $Y=M\varphi(X)$ - вектор-функция математических ожиданий вектор-функции $\varphi(X)$. Формула обобщённой теоремы оценки точности:
$$K_Y=A\cdot K_X\cdot A^T$$
где $K_Y$ - корреляционная матрица математических ожиданий; $K_X$ - корреляционная матрица аргументов функций; $A$ - матрица частных производных;
$$A_{ij}=\frac{\partial Y_i}{\partial X_j}$$</p>
<h3 id="toc-id-19">Переопределённые системы уравнений. Задача уравнивания.</h3>
<p>Часто в геодезической практике число уравнений $n$ больше числа неизвестных $k$. Такую систему уравнений называют переопределённой. Решений она не имеет. Рассмотрим уравнение:
$$\underset{n\times k}{A}\cdot\underset{k\times1}{x}+\underset{n\times 1}{C}=0$$
Чтобы решить данную систему, её умножают слева на $\underset{k\times n}{A^T}\cdot\underset{n\times n}{S}$. Так, система будет состоять из $k$ уравнений и $k$ неизвестных.
$$A^TSAx+A^TSC=0$$
Пусть $\underset{k\times k}{R}=\underset{k\times n}{A^T}\cdot\underset{n\times n}{S}\cdot\underset{n\times k}{A}$; $\underset{k\times1}{b}=\underset{k\times n}{A^T}\cdot\underset{n\times n}{S}\cdot\underset{n\times1}{C}$.
$$\underset{k\times k}{R}\cdot\underset{k\times 1}{x}+\underset{k\times 1}{b}=0$$
Матрица $R$ является нормальной ($R^TR=RR^T$), поэтому полученная система уравнений называется системой нормальных уравнений.</p>
<p>Получим: $$x=-R^{-1}b$$
Но при подстановке данного решения в исходную систему, получим один из следующих случаев:
$$Ax+C=0\quad\text{или}\quad Ax+C=V$$
При $Ax+C=0$ система совместна. При $Ax+C=V$ система несовместна, однако матрица $V$ будет обладать следующим свойством:
$$V^TSV=\min$$
Докажем это свойство. Обозначим $\Phi=V^TSV$, $V=Ax+C$. Найдём экстремум этой функции, приравняв производную к нулю:
$$\frac{\partial\Phi}{\partial x}=\frac{\partial\Phi}{\partial V}\frac{\partial V}{\partial x}=\frac{\partial V^TSV}{\partial V}\frac{\partial Ax+C}{\partial x}=2V^TS\cdot A$$
$$2V^TSA=0$$
$$A^TSV=0$$
$$A^TS(Ax+C)=0$$
$$A^TSAx+A^TSC=0$$
Мы опять пришли к нормальному уравнению. Это значит, что решение уравнения является минимумом функции $\Phi$.</p>
<p>При построении геодезических сетей мы измеряем различные величины: длины линий, углы, превышения, время (в спутниковых сетях) при том, что определяемыми величинами являются плановые и высотные координаты пунктов геодезических сетей.</p>
<p>Число измерений $n$ всегда больше числа координат. Наличие в сети избыточных измерений приводит к неоднозначности определения неизвестных. В этом случае возникает задача уравнивания.</p>
<p>Задачей уравнивания называется определение наиболее достоверных значений неизвестных и оценка их точности. Несмотря на сложность задачи, избыточные измерения позволяют контролировать результаты измерений, выполнять оценку точности и повышать надёжность результатов.</p>
<p>Существует два основных способа уравнивания: параметрический и коррелатный.</p>
<p>Обозначают:
$X$ - истинные значения неизвестных параметров;
$Y$ - истинные значения измеренных величин;
$y$ - результаты измерений.</p>
<h3 id="toc-id-20">Параметрический способ уравнивания.</h3>
<h4 id="toc-id-21">Вывод основных формул, порядок уравнивания.</h4>
<p>Запишем уравнения связи между измеренными значениями и неизвестными
$$Y=\varphi(X)$$
В общем случае уравнения связи нелинейные. Приведём их к линейному виду, разложив в ряд Тейлора:
$$Y=\varphi\left(X^{(0)}\right)+\left(\frac{\partial Y}{\partial X}\right)\left(X-X^{(0)}\right)+\zeta$$
Где $X^{(0)}$ - приближённое значение неизвестных; $\zeta$ - остаточный член.
Примем $\left(\frac{\partial Y}{\partial X}\right)=A$; $\zeta=0$; $X-X^{(0)}=\Delta X$; $\varphi(X^{(0)})-Y=\overline{L}$.
$$\underset{n\times k}{A}\cdot\underset{k\times 1}{\Delta X}+\underset{n\times 1}{\overline L}=0$$
Данная система является переопределённой, т.к. $n&gt;k$. Ранее, чтобы перейти к определённой системе, мы умножали её слева на $A^TS$, где $S$ - квадратная матрица размера $n\times n$. В геодезии в качестве матрицы $S$ мы используем матрицу весов измерений $P$.
$$A^TPA\Delta X+A^TP\overline{L}=0$$
Пусть $R=A^TPA$, $\overline{b}=A^TP\overline{L}$
$$R\Delta X+\overline{b}=0$$
$$\Delta X=-R^{-1}\overline{b}$$
Из принятого ранее $X-X^{(0)}=\Delta X$, получим:
$$X=X^{(0)}+\Delta X$$
Задача была бы решена, если бы нам был известен вектор $Y$ истинных измерений. Но у нас есть лишь результаты измерений $y$. И вместо вектора $\overline{L}$ мы вычислим вектор $L$:
$$L=\varphi(X^{(0)})-y$$
Тогда вместо поправок к истинным значениям неизвестных мы получим поправки к уравненным значениям неизвестных.
$$R\Delta x+b=0,\quad b=A^TPL$$
$$\Delta x=-R^{-1}b$$
$$\widetilde{X}=X^{(0)}+\Delta x$$
Если теперь полученный вектор-решение $\Delta x$ подставить в переопределённую систему уравнений, получим несовместную систему:
$$A\Delta x+L=V$$
где $V$ - поправка к измеренному значению, полученное из уравнивания. Если в исходную систему связи измеренных значений и неизвестных вместо истинного значения $X$ подставить уравненное $\widetilde{X}$, то получим уравненное значение измерений. 
$$\widetilde{y}=y+V=\varphi(\widetilde{X})$$</p>
<p>Порядок уравнивания параметрическим способом:</p>
<ol>
<li>Выбираем неизвестные и обозначаем из за $X$;</li>
<li>Составляем уравнения связи между измеренными значениями и неизвестными в виде функции от неизвестных $$y=\varphi(x)$$</li>
<li>Составляем параметрические уравнения поправок $$\underset{n\times1}{V}=\underset{n\times k}{A}\cdot\underset{k\times 1}{\Delta x}+\underset{n\times 1}{L}$$ где $V$ - матрица поправок к измеренным значениям, полученным из уравнивания; $A$ - матрица коэффициентов уравнений поправок; $L$ - матрица свободных членов уравнений поправок. В подробной записи: $$\underset{n\times k}{A}=\begin{pmatrix}a_1&amp;b_1&amp;\ldots&amp;g_1\\ a_2&amp;b_2&amp;\ldots&amp;g_2\\ \vdots&amp;\vdots&amp;\ddots&amp;\vdots\\ a_n&amp;b_n&amp;\ldots&amp;g_n\end{pmatrix}$$$$a_{ij}=\frac{\partial y_i}{\partial x_j}$$ $$v_i=a_i\delta x_i+b_i\delta x_2+\ldots+g_i\delta x_k+l_i$$ $$a_i=\frac{\partial y_i}{\partial x_1};\quad b_i=\frac{\partial y_i}{\partial x_2};\quad\ldots;\quad g_i=\frac{\partial y_i}{\partial x_k};\quad l_i=\varphi_i(x)-y$$</li>
<li>Находим приближённые значения неизвестных $X^{(0)}$ и вычисляем свободные члены параметрических уравнений поправок $$L=\varphi(x)-y$$</li>
<li>Составим систему нормальных уравнений $$R\Delta x+b=0$$ где $R=A^TPA$ - матрица коэффициентов нормальных уравнений. Она имеет следующие свойства:<ol>
<li>Под диагонали стоят квадратичные элементы;</li>
<li>Недиагональные элементы симметричны относительно главной диагонали;</li>
<li>Определитель матрицы $R$ положительный.</li>
</ol>
</li>
<li>Находим поправки к приближённым значениям неизвестных как вектор решения нормальных уравнений: $$\Delta x=-R^{-1}b$$</li>
<li>Вычисляем уравненное значение неизвестных: $$\widetilde{X}=X^{(0)}+\Delta x$$</li>
<li>Оценка точности.</li>
</ol>
<h4 id="toc-id-22">Контроль уравнительных вычислений.</h4>
<p>Контроль уравнительных вычислений выполняется вычислением квадратичной формы $\Phi$ двумя способами. Первый способ:</p>
<p>$$\Phi=[pv^2]=V^TPV=(A\Delta x+L)^TP(A\Delta x+L)=$$
$$=(\Delta x^TA^T+L^T)P(A\Delta x+L)=(\Delta x^TA^TP+L^TP)(A\Delta x+L)=$$
$$=\Delta x^TA^TPA\Delta x+\Delta x^TA^TPL+L^TPA\Delta x+L^TPL=$$
$$=\Delta x^T(\underbrace{A^TPA\Delta x+A^TPL}_{R\Delta x+b=0})+L^TPA\Delta x+L^TPL=$$
$$=L^TPA\Delta x+L^TPL=b^T\Delta x+L^TPL$$</p>
<p>Второй способ. Сначала вычислим уравненное значение свободного члена.
$$L=\varphi(X^{(0)})-y$$
$$\widetilde{L}=\varphi(X^{(0)}+\Delta x)-y=\varphi(\widetilde{X})-y$$
При его вычислении уже был учтён вектор решения $\Delta x$, поэтому вместо $\Phi=b^T\Delta x+L^TPL$ можно записать:
$$\Phi=\widetilde{L}^TP\widetilde{L}$$</p>
<p>Контролем уравнительных вычислений будет соблюдение равенств $\Phi$, полученных по двум формулам в пределах ошибки округления.</p>
<h4 id="toc-id-23">Оценка точности в параметрическом способе уравнивания.</h4>
<h4 id="toc-id-24">Ошибка единицы веса</h4>
<p>Ошибка единицы веса вычисляется по формуле:
$$\mu=\sqrt{\frac{[pv^2]}{n-k}}$$
где $[pv^2]=\Phi$; $n$ - общее число измерений; $k$ - число необходимых измерений. Эта формула называется формулой Бесселя при уравнительных вычислениях. Вывод этой формулы содержится в коррелатном способе уравнивания.</p>
<h4 id="toc-id-25">Оценка точности уравненных неизвестных</h4>
<p>$$\widetilde{X}=X^{(0)}+\Delta x$$
Так как $\widetilde{X}$ представляет собой несколько функций, для оценки точности этих величин надо знать корреляционную матрицу, которая может быть получена по обобщённой теореме оценки точности. Но чтобы использовать эту теорему, необходимо выразить уравнение в виде линейной функции с известной корреляционной матрицей.
$$\widetilde{X}=X^{(0)}+(-R^{-1}b)=$$
$$=X^{(0)}+\left(-(A^TPA)^{-1}A^TPL\right)=$$
$$=X^{(0)}+\left(-(A^TPA)^{-1}A^TP(\varphi(X^{(0)})-y)\right)=$$
$$=X^{(0)}+R^{-1}A^TP\varphi(X^{(0)})+R^{-1}A^TPy$$
Обозначим $C_1=X^{(0)}+R^{-1}A^TP\varphi(X^{(0)})$; $C=R^{-1}A^TP$. Получим:
$$\widetilde{X}=Cy+C_1$$
Применим обобщённую теорему оценки точности:
$$K_{\widetilde{X}}=CK_yC^T=R^{-1}A^TPK_yPAR^{-1}$$
Любую неравноточную величину можно оценить по формуле:
$$\sigma_i=\sigma_o\sqrt{\frac{1}{P_i}}$$
где $\sigma_i$ - СКО $i$-й неравноточной величины; $\sigma_0$ - СКО единицы веса. Если измерения независимы, то корреляционную матрицу измерений $K_y$ можно представить в виде
$$K_y=diag{\sigma_i^2}=\sigma_0^2\cdot P^{-1}$$
Вернёмся к обобщённой теореме оценки точности:
$$K_{\widetilde{X}}=\sigma_0^2\cdot R^{-1}\underbrace{A^TPP^{-1}PA^T}_{R}R^{-1}=\sigma_0^2\cdot R^{-1}$$</p>
<p>Обозначим $Q=R^{-1}$ - матрица обратных весов уравненных неизвестных. На диагонали у неё будут стоять обратные веса ($Q_{ii}=\frac{1}{P_{\widetilde{X_i}}}$), а недиагональные элементы - это корреляционные моменты.
$$K_{x_ix_j}=\sigma_0^2Q_{ij};\quad r_{x_ix_j}=\frac{K_{x_ix_j}}{\sigma_{x_i}\sigma_{x_j}}=\frac{\sigma_0^2Q_{ij}}{\sigma_0\sqrt{Qii}\cdot\sigma_0\sqrt{Q_{jj}}}=\frac{Q_{ij}}{\sqrt{Qii}\sqrt{Q_{jj}}}$$</p>
<h4 id="toc-id-26">Оценка точности функции уравненных неизвестных</h4>
<p>Часто нужно оценить не только уравненные неизвестные, но и их функции (превышения, длины линий, дирекционные углы).
$$\widetilde{F}=F(\widetilde{X_1}, \widetilde{X_2},\ldots,\widetilde{X_k})$$
В общем случае функция уравненных весов нелинейна. Приведём её к линейному виду, используя ряд Тейлора.
$$\widetilde{F}=F\left(X^{(0)}\right)+\left(\frac{\partial\widetilde F}{\partial X}\right)\left(\widetilde{X}-X^{(0)}\right)+\zeta$$
Пусть $\frac{\partial\widetilde{F}}{\partial X}=\varphi$, $\varphi_{ij}=\frac{\partial F_i(\widetilde X)}{\partial X_j}$, $\zeta=0$, $\widetilde{X}-X^{(0)}=\Delta x$
$$\widetilde{F}=F(X^{(0)})+\varphi\Delta x$$
Для оценки точности функции уравненных значений $\widetilde{F}$ применим обобщённую теорему оценки точности.
$$K_{\widetilde{F}}=\varphi K_{\Delta x}\varphi^T$$
Учитывая, что $K_{\Delta x}=K_{\widetilde{x}}=\sigma_0^2\cdot Q$, получим:
$$K_{\widetilde{F}}=\sigma_0^2\cdot\varphi Q\varphi^T=\sigma_0^2\cdot P_{\widetilde{F}}^{-1}$$
Откуда $$P_{\widetilde{F}}^{-1}=\varphi Q\varphi^{T}$$</p>
<h3 id="toc-id-27">Коррелатный способ уравнивания.</h3>
<h4 id="toc-id-28">Вывод основных формул коррелатного способа уравнивания</h4>
<p>Коррелатный способ уравнивания основан на точных геометрических условиях, возникающих в геодезических сетях. Например, в треугольнике точное геометрическое условие возникнет, если будут измерены все три угла. Для определения всех углов треугольника достаточно знать два из них. Измерение третьего узла в треугольнике является избыточным. Но пока мы не знаем третий угол, геометрическое условие не возникнет. Каждое избыточное измерение в геодезической сети приводит к возникновению геометрической зависимости.</p>
<p>В общем виде любое геометрическое условие можно записать как:
$$\varphi(Y)=0$$
В общем виде это уравнение нелинейно. Приведём его к линейному виду, разложив в ряд Тейлора и отбросив остаточные члены разложения.
$$\varphi(Y)=\varphi(Y^{(0)})+\frac{\partial\varphi(Y)}{\partial Y}(Y-Y^{(0)})+\xi$$
Примем в качестве приближённого значения истинного результата измерений измеренное значение $y$: $Y^{(0)}=y$.
$$\varphi(Y)=\varphi(y)+\frac{\partial\varphi(Y)}{\partial Y}(Y-y)$$
Примем $\frac{\partial\varphi(Y)}{\partial Y}=B$; $y-Y=\Delta$; $\varphi(y)-\varphi(Y)=w$.
$$\underset{r\times n}{B}\cdot\underset{n\times1}{(-\Delta)}+\underset{r\times1}{w}=0$$
Эта система является недоопределённой. Введём поправки $V=-\Delta$
$$BV+w=0$$
Эта система называется системой условных уравнений поправок. Для отыскания $V$ решим систему под условием метода наименьших квадратов ($\Phi=V^TPV=min$). Лагранж предложил решить эту систему при помощи неопределённых множителей $\lambda$. Для этого введём функцию, являющуюся суммой условия минимума и данной системы, умноженной на неопределённые множители.
$$G=V^TPV+\lambda(BV+w)$$
Так как множители Лагранжа не определены, заменим их коррелатными ($\lambda=-2K^T$).
$$G=V^TPV-2K^T(BV+w)$$
Найдём производную и приравняем её к нулю.
$$2V^TP-2K^TBV=0$$
$$V^T=K^TBP^{-1}$$
$$V=P^{-1}B^TK$$
Для определения вектора коррелат подставим это решение в систему условных уравнений поправок.
$$BP^{-1}B^TK+w=0$$
Пусть $BP^{-1}B^T=N$
$$NK+w=0$$
Мы получили определённую систему, называемую системой нормальных уравнений коррелатного способа.
$$K=-N^{-1}w$$
Теперь возможно вычислить вектор поправок к измеренным значениям ($V$).</p>
<h4 id="toc-id-29">Порядок уравнивания коррелатным способом</h4>
<ol>
<li>Подсчитываем количество избыточных измерений;</li>
<li>Составляем геометрические условия (в уравнивание включаем только независимые геометрические условия. Их число будет равно числу избыточных измерений);</li>
<li>Составляем условные уравнения поправок $$BV+w=0$$</li>
<li>Определяем невязки условных уравнений;</li>
<li>Составляем нормальные уравнения коррелат $$NK+w=0$$</li>
<li>Получаем коррелаты из решения нормальных уравнений $$K=-N^{-1}w$$</li>
<li>Вычисляем поправки к измеренным значениям $$V=P^{-1}B^TK$$</li>
<li>Вычисляем уравненные значения измерений;</li>
<li>Вычисляем уравненные значения неизвестных, используя уравненные значения измерений по формулам, известным из геодезии;</li>
<li>Оценка точности.</li>
</ol>
<p>Пример. Уравнять углы в треугольнике коррелатным способом.</p>
<ol>
<li>$r=2$;</li>
<li>$Y_1+Y_2+Y_3-180^\circ=0$;</li>
<li>$BV+w=0,\quad v1+v2+v3+w=0$;</li>
<li>$w=y_1+y_2+y_3-180^\circ$</li>
<li>$NK+w=0$;</li>
<li>$N=BB^T=(111)\cdot(111)^T=3,\quad 3K+w=0,\quad K=-w/3;$</li>
<li>$V=B^TK=(-w/3,-w/3,-w/3)$;</li>
<li>$\widetilde{y_i}=y_i-w/3$.</li>
</ol>
<h4 id="toc-id-30">Контроль грубых ошибок по невязкам условных уравнений</h4>
<p>Одним из преимуществ коррелатного способа является возможность контроля грубых ошибок измерений. Запишем линейный вид исходного уравнения связи.
$$B(-\Delta)+w=0$$
$$w=B\cdot\Delta$$
Рассмотрим свойства невязок. Найдём математическое ожидание невязки.
$$M_w=B\cdot M_\Delta$$
Будем считать, что систематической ошибки нет. Математическое ожидание случайной ошибки равно нулю. Случайные ошибки подчиняются нормальному закону распределения, значит и невязка подчиняется нормальному закону распределения. А значит, к невязкам может быть применено правило трёх сигм.
$$|d_j|=3\sigma_{w_j}$$
Если окажется, что полученная невязка больше предельной, то в измерениях присутствует грубая ошибка и измерения необходимо повторить.</p>
<p>Найдём корреляционную матрицу невязки, чтобы определить СКО $\sigma_w$
$$K_\Delta=K_y=\sigma_0^2P^{-1}$$
Применим обобщённую теорему оценки точности
$$K_w=BK_\Delta B^T=\sigma_0^2BP^{-1}B^T=\sigma_0^2N$$
Обратная весовая матрица невязок совпадает с матрицей коэффициентов нормальных уравнений коррелат.
$$P_w^{-1}=N$$
Мы знаем, что диагональные элементы это дисперсии. Тогда для любой невязки $w_j$:
$$\sigma_{w_j}^2=\sigma_0^2\frac{1}{P_{w_j}}=\sigma_0^2N_{jj}$$
$$\sigma_{w_j}=\sigma_0\sqrt{\frac1{P_{w_j}}}=\sigma_0\sqrt{N_{jj}}$$
Тогда
$$d_j=t\sigma_0\sqrt{N_{jj}}=3\sigma_0\sqrt{N_{jj}}$$
По этой формуле производят отбраковку грубых ошибок по невязкам условных уравнений.</p>
<h4 id="toc-id-31">Оценка точности в коррелатном способе уравнивания</h4>
<p>1 формула.
Контрольные формулы для вычисления квадратичной формы $[pvv]$.
$$V=P^{-1}B^TK$$
$$V^TPV=K^TBP^{-1}PP^{-1}B^TK$$
Учитывая, что $BP^{-1}B^T=N$:
$$\boxed{V^TPV=K^TNK}$$</p>
<p>2 формула.
$$NK+w=0$$
$$NK=-w$$
$$\boxed{V^TPV=-K^Tw=-[kw]}$$
Чаще всего для контроля используется вторая формула.</p>
<p>$$K=-N^{-1}w$$
$$K^T=-w^TN^{-1}$$
$$\boxed{V^TPV=w^TN^{-1}w}$$</p>
<h4 id="toc-id-32">Вывод формулы Бесселя для вычисления ошибки единицы веса</h4>
<p>Вспомним формулу Гаусса для вычисления оценки дисперсии единицы веса - ошибки единицы веса.
$$\mu^2=\frac{[p\Delta\Delta]}n$$
$\Delta$ - истинная ошибка измерений; $p$ - вес измерения.
В матричном виде:
$$\mu^2=\frac{\Delta^TP\Delta}{n}$$
Эта формула применяется и при зависимых измерений. Её ещё называют обобщённой формулой Гаусса.</p>
<p>Истинные ошибки нам практически никогда не известны. Так как невязка является истинной ошибкой нуля, в этой формуле истинные ошибки заменим невязками.
$$\mu^2=\frac{w^TP_ww}{r}$$
Вспомним, что $P_w=N^{-1}$.
$$\mu^2=\frac{w^TN^{-1}w}{r}$$
Согласно третьей контрольной формуле
$$V^TPV=w^TN^{-1}w$$
Тогда
$$\mu^2=\frac{V^TPV}{r}$$
В подробной записи
$$\mu^2=\frac{[pvv]}{r}$$</p>
<h4 id="toc-id-33">Оценка точности измерений при коррелатном способе уравнивания</h4>
<p>Для оценки точности любой системы функций необходимо определить её корреляционную матрицу
$$\widetilde{y}=y+V$$
$$V=P^{-1}B^TK=-P^{-1}B^TN^{-1}w$$
$$\widetilde y=y-P^{-1}B^TN^{-1}w$$
Учитывая, что $W=B\cdot\Delta$ и $\Delta=y-Y$, запишем формулу в виде
$$\widetilde y=Y+\Delta-P^{-1}B^TN^{-1}B\Delta$$
Вынесем $\Delta$ за скобки и обозначим $E-P^{-1}B^TN^{-1}B=C$
$$\widetilde y=Y+C\Delta$$
Применим к выражению обобщённую теорему оценки точности.
$$P_{\widetilde y}^{-1}=CP_\Delta^{-1}C^T=(E-P^{-1}B^TN^{-1}B)P^{-1}(E-P^{-1}B^TB^{-1}B)^T$$
$$=P^{-1}-P^{-1}B^TN^{-1}BP^{-1}-P^{-1}B^TN^{-1}BP^{-1}+P^{-1}B^TN^{-1}BP^{-1}B^TN^{-1}BP^{-1}$$
Учитывая, что $BP^{-1}B^T=N$:
$$P_{\widetilde y}^{-1}=P^{-1}-P^{-1}BN^{-1}BP^{-1}$$
В полученной матрице $P^{-1}$ обратные веса уравненных измерений находятся на диагонали.</p>
<p>Вторую часть полученных формул можно трактовать как обратный вес поправки.
$$P_V^{-1}=P^{-1}B^TN^{-1}BP^{-1}$$
Тогда формулы вычисления обратных весов можно записать в виде
$$P_{\widetilde y}^{-1}=P_y^{-1}-P_V^{-1}$$
Перейдём
$$m_{\widetilde y_i}=\mu\sqrt{\frac1{P_{\widetilde{y_i}}}}$$</p>
<h4 id="toc-id-34">Оценка точности функций уравненных измерений</h4>
<p>$$\widetilde F=F(\widetilde y_1,\widetilde y_2,\ldots,\widetilde y_n)$$
В параметрическом способе мы доказали, что обратный вес функции уравненных значений определяют по формуле
$$P_{\widetilde F}^{-1}=fQf^T=fP^{-1}f^T$$
Подставим в эту формулу обратный вес уравненных измерений
$$P_{\widetilde F}^{-1}=fP_{\widetilde y}^{-1}f^T=fP^{-1}B^TN^{-1}BP^{-1}f^T$$
В коррелатном способе элементы весовой матрицы $f$ будут равны частным производным от функции по каждому измерению
$$f_{ij}=\frac{\partial \widetilde F_i}{\partial y_j}$$
В матрице $P_{\widetilde F}^{-1}$ по диагонали будут стоять обратные веса функций уравненных измерений, выбранные для оценки.</p>
<p>СКО любой $i$-й функции
$$m_{\widetilde F_i}=\mu\sqrt{\frac{1}{P_{\widetilde F_i}}}$$</p>
<h4 id="toc-id-35">Повышение веса в результате уравнивания</h4>
<p>Рассмотрим эту задачу на примере уравненных углов треугольника. Углы в треугольнике равноточны. Поэтому используем формулу обратного веса уравненных углов для равноточных измерений.
$$P_{\widetilde y}^{-1}=E-B^TN^{-1}B$$
$$B=\begin{pmatrix}1&amp;1&amp;1\end{pmatrix}$$
$$N=BB^T=3$$
$$P_{\widetilde y}^{-1}=\begin{pmatrix}1&amp;0&amp;0\\ 0&amp;1&amp;0\\ 0&amp;0&amp;1\end{pmatrix}-\frac13\begin{pmatrix}1\\ 1\\ 1\end{pmatrix}\begin{pmatrix}1&amp;1&amp;1\end{pmatrix}=\frac13\begin{pmatrix}2&amp;-1&amp;-1\\ -1&amp;2&amp;-1\\ -1&amp;-1&amp;2\end{pmatrix}$$
$$P_{\widetilde y_i}^{-1}=\frac23P_{\widetilde y_i}=1.5$$
Как видим, после уравнивания вес увеличился. В общем случае соотношение веса уравненного к неуравненному
$$\frac{P_{\widetilde y}}{P_y}=\frac nk$$
Это соотношение выполняется для простейших случаев. Для сложных геодезических сетей оно выполняется в среднем для сети. Для тригонометрического хода, уравненного по углам:
$$P_{\widetilde y}^{-1}=n\begin{pmatrix}n-1&amp;-1&amp;\ldots&amp;-1\\ -1&amp;n-1&amp;\ldots&amp;-1\\  \vdots&amp;\vdots&amp;\ddots&amp;\vdots\\ -1&amp;-1&amp;\ldots&amp;n-1\end{pmatrix}$$</p>
<h3 id="toc-id-36">Примеры задач</h3>
<h4 id="toc-id-37">Вычисление СКО функции</h4>
<p>Напишите формулу для вычисления СКО значения функции $u=L\cdot cos^2\nu$</p>
<p>$$m_u^2=\sum_{i=1}^n\left(\frac{\partial u}{\partial x_i}\right)^2m_{x_i}^2$$
$$m_u^2=\left(\frac{\partial u}{\partial L}\right)^2m_L^2+\left(\frac{\partial u}{\partial \nu}\right)^2m_\nu^2$$
$$\frac{\partial u}{\partial L}=cos^2\nu$$
$$\frac{\partial u}{\partial\nu}=cos^4\nu\cdot m_L^2+L^2sin^22\nu\cdot m_\nu^2$$
$$m_u=\sqrt{cos^4\nu\cdot m_L^2+L^2sin^22\nu\cdot m_\nu^2}$$</p>
<h4 id="toc-id-38">Обратная задача оценки точности</h4>
<p>Превышения определяются по формуле тригонометрического нивелирования. С какой точностью должны быть измерены расстояние $S$ и угол наклона $\nu$, если требуется получить превышения с точностью не грубее $m_h=5$см при измеряемых $S\leq 250$м и $|\nu|\leq6^\circ$.
$$h=S\cdot tg\nu$$
$$m_{x_i}=\frac{m_u}{\left|\frac{\partial u}{\partial x_i}\right|\sqrt n}$$
$$\frac{\partial h}{\partial S}=tg\nu$$
$$\frac{\partial h}{\partial\nu}=\frac{S}{cos^2\nu}$$
$$m_S\leq\frac{m_h}{\left|\frac{\partial h}{\partial S}\right|\cdot\sqrt n}=33,6\text{см}$$
$$m_\nu\leq\frac{m_h\cdot\rho'}{\left|\frac{\partial h}{\partial \nu}\right|\cdot\sqrt n}=0,5'$$</p>
</body></html></article></main></body></html>